2025-11-12 02:20:02,287 - INFO - üöÄ Iniciando ETL para SEGUIMIENTO TEMPERAS Y VINILOS...
2025-11-12 02:20:02,373 - INFO - ‚úÖ Conectado a MySQL
2025-11-12 02:20:02,373 - INFO - üìñ Leyendo archivo Excel: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-12 02:20:02,565 - INFO - ‚úÖ Hoja encontrada: Base De Datos
2025-11-12 02:20:05,360 - INFO - üìä Datos cargados: 8216 filas, 58 columnas
2025-11-12 02:21:05,495 - INFO - üßπ Limpiando y transformando datos...
2025-11-12 02:21:05,519 - INFO - Filas despu√©s de eliminar vac√≠as: 8209/8216
2025-11-12 02:21:05,537 - INFO - Columnas despu√©s de eliminar vac√≠as: 58/58
2025-11-12 02:21:05,560 - INFO - ‚úÖ Datos limpiados: 8209 filas, 58 columnas
2025-11-12 02:21:05,611 - INFO - üíæ Cargando datos a MySQL...
2025-11-12 02:21:07,138 - INFO - ‚úÖ Tabla 'seguimiento_temperas_vinilos' cargada exitosamente
2025-11-12 02:21:07,138 - INFO - üìä Total de registros: 8209
2025-11-12 02:21:07,154 - INFO - üéâ ETL completado exitosamente!
2025-11-12 21:26:54,811 - INFO - ‚úÖ Conectado a MySQL
2025-11-12 21:26:54,812 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-12 21:26:59,965 - INFO - üßπ Limpiando y transformando datos...
2025-11-12 21:26:59,998 - ERROR - Error limpiando datos: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-11-12 21:32:07,032 - INFO - ‚úÖ Conectado a MySQL
2025-11-12 21:32:07,033 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-12 21:32:11,575 - INFO - üßπ Limpiando y transformando datos...
2025-11-12 21:32:11,624 - ERROR - Error limpiando datos: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-11-12 21:37:45,363 - INFO - ‚úÖ Conectado a MySQL
2025-11-12 21:37:45,363 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-12 21:37:49,898 - INFO - üßπ Limpiando y transformando datos...
2025-11-12 21:37:49,921 - ERROR - Error limpiando datos: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-11-12 21:37:49,926 - ERROR - Traceback (most recent call last):
  File "/workspaces/ProyectoOEE/etl/etl_structured.py", line 286, in clean_and_transform_data
    if null_count > 0:
       ^^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-11-12 21:42:35,257 - INFO - ‚úÖ Conectado a MySQL
2025-11-12 21:42:35,257 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-12 21:42:39,689 - INFO - üßπ Limpiando y transformando datos...
2025-11-12 21:42:39,710 - ERROR - Error limpiando datos: can only convert an array of size 1 to a Python scalar
2025-11-12 21:42:39,712 - ERROR - Traceback (most recent call last):
  File "/workspaces/ProyectoOEE/etl/etl_structured.py", line 288, in clean_and_transform_data
    null_count = df[col].isna().sum().item()  # .item() asegura que sea un valor escalar
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/pandas/core/base.py", line 422, in item
    raise ValueError("can only convert an array of size 1 to a Python scalar")
ValueError: can only convert an array of size 1 to a Python scalar

2025-11-12 21:46:21,077 - INFO - ‚úÖ Conectado a MySQL
2025-11-12 21:46:21,078 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-12 21:46:25,487 - INFO - üßπ Limpiando y transformando datos...
2025-11-12 21:46:25,521 - ERROR - Error limpiando datos: arg must be a list, tuple, 1-d array, or Series
2025-11-12 21:46:25,523 - ERROR - Traceback (most recent call last):
  File "/workspaces/ProyectoOEE/etl/etl_structured.py", line 298, in clean_and_transform_data
    df[col] = pd.to_numeric(df[col], errors='coerce').fillna(0)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/pandas/core/tools/numeric.py", line 209, in to_numeric
    raise TypeError("arg must be a list, tuple, 1-d array, or Series")
TypeError: arg must be a list, tuple, 1-d array, or Series

2025-11-12 21:55:53,724 - INFO - ‚úÖ Conectado a MySQL
2025-11-12 21:55:53,725 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-12 21:55:58,201 - INFO - üßπ Limpiando y transformando datos...
2025-11-12 21:55:58,907 - ERROR - Error limpiando datos: 'DataFrame' object has no attribute 'dtype'
2025-11-12 21:55:58,911 - ERROR - Traceback (most recent call last):
  File "/workspaces/ProyectoOEE/etl/etl_structured.py", line 374, in clean_and_transform_data
    if col in self.columnas_numericas and df[col].dtype == 'object':
                                          ^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 6318, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'. Did you mean: 'dtypes'?

2025-11-12 21:56:33,714 - INFO - ‚úÖ Conectado a MySQL
2025-11-12 21:56:33,714 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-12 21:56:38,230 - INFO - üßπ Limpiando y transformando datos...
2025-11-12 21:56:38,975 - ERROR - Error limpiando datos: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-11-12 21:56:38,978 - ERROR - Traceback (most recent call last):
  File "/workspaces/ProyectoOEE/etl/etl_structured.py", line 374, in clean_and_transform_data
    if col in self.columnas_numericas and df[col].dtypes == 'object':
                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-11-12 21:57:23,116 - INFO - ‚úÖ Conectado a MySQL
2025-11-12 21:57:23,116 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-12 21:57:27,530 - INFO - üßπ Limpiando y transformando datos...
2025-11-12 21:57:28,277 - ERROR - Error limpiando datos: 'DataFrame' object has no attribute 'dtype'
2025-11-12 21:57:28,281 - ERROR - Traceback (most recent call last):
  File "/workspaces/ProyectoOEE/etl/etl_structured.py", line 374, in clean_and_transform_data
    if col in self.columnas_numericas and df[col].dtype == 'object':
                                          ^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 6318, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'. Did you mean: 'dtypes'?

2025-11-12 22:01:42,417 - INFO - ‚úÖ Conectado a MySQL
2025-11-12 22:01:42,417 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-12 22:01:46,794 - INFO - üßπ Limpiando y transformando datos...
2025-11-12 22:01:46,911 - ERROR - Error limpiando datos: 'DataFrame' object has no attribute 'dtype'
2025-11-12 22:01:46,915 - ERROR - Traceback (most recent call last):
  File "/workspaces/ProyectoOEE/etl/etl_structured.py", line 381, in clean_and_transform_data
    if df[col].dtype == 'object':
       ^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 6318, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'. Did you mean: 'dtypes'?

2025-11-12 22:02:41,999 - INFO - ‚úÖ Conectado a MySQL
2025-11-12 22:02:42,000 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-12 22:02:46,566 - INFO - üßπ Limpiando y transformando datos...
2025-11-12 22:02:46,680 - ERROR - Error limpiando datos: 'DataFrame' object has no attribute 'dtype'
2025-11-12 22:02:46,685 - ERROR - Traceback (most recent call last):
  File "/workspaces/ProyectoOEE/etl/etl_structured.py", line 381, in clean_and_transform_data
    if df[col].dtype == 'object':
       ^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 6318, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'. Did you mean: 'dtypes'?

2025-11-12 22:18:25,885 - INFO - ‚úÖ Conectado a MySQL
2025-11-12 22:18:25,886 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-12 22:18:30,412 - INFO - üßπ Limpiando y transformando datos...
2025-11-12 22:18:31,207 - ERROR - ‚ùå Error cargando tabla: A column with name 'horas_trabajadas' is already present in table 'seguimiento_temperas_vinilos'.
2025-11-12 22:23:56,993 - INFO - ‚úÖ Conectado a MySQL
2025-11-12 22:23:56,994 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-12 22:24:01,416 - INFO - üßπ Limpiando y transformando datos...
2025-11-13 13:31:49,303 - ERROR - ‚ùå Error conectando a MySQL: (mysql.connector.errors.DatabaseError) 2003 (HY000): Can't connect to MySQL server on 'localhost:3306' (111)
(Background on this error at: https://sqlalche.me/e/20/4xp6)
2025-11-13 13:35:22,053 - INFO - ‚úÖ Conectado a MySQL
2025-11-13 13:35:22,058 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-13 13:35:25,707 - INFO - üßπ Limpiando y transformando datos...
2025-11-13 13:35:26,285 - ERROR - Error creando tablas espec√≠ficas: "['pacas_producidas', 'tiempo_de_paro'] not in index"
2025-11-13 13:35:26,368 - ERROR - Traceback (most recent call last):
  File "/workspaces/ProyectoOEE/etl/etl_structured.py", line 400, in crear_tablas_especificas
    df_temp = df[columnas_produccion_maquina].copy()
              ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/ProyectoOEE/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/ProyectoOEE/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/workspaces/ProyectoOEE/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['pacas_producidas', 'tiempo_de_paro'] not in index"

2025-11-13 13:51:36,267 - INFO - ‚úÖ Conectado a MySQL
2025-11-13 13:51:36,267 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-13 13:51:39,626 - INFO - üßπ Limpiando y transformando datos...
2025-11-13 16:19:04,956 - ERROR - ‚ùå Error conectando a MySQL: (mysql.connector.errors.DatabaseError) 2003 (HY000): Can't connect to MySQL server on 'localhost:3306' (111)
(Background on this error at: https://sqlalche.me/e/20/4xp6)
2025-11-13 16:19:47,471 - INFO - ‚úÖ Conectado a MySQL
2025-11-13 16:19:47,472 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-13 16:19:52,885 - INFO - üßπ Limpiando y transformando datos...
2025-11-13 16:40:33,281 - INFO - ‚úÖ Conectado a MySQL
2025-11-13 16:40:33,283 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-13 16:40:37,681 - INFO - üßπ Limpiando y transformando datos...
2025-11-13 16:40:38,491 - ERROR - ‚ùå Error cargando tabla Produccion_maquina: (mysql.connector.errors.DataError) 1406 (22001): Data too long for column 'turno_final' at row 15
[SQL: INSERT INTO produccion_maquina (fecha, mes, maquina, pacas_producidas, horas_trabajadas, tiempo_de_paro, turno_inicio, turno_final) VALUES (%(fecha)s, %(mes)s, %(maquina)s, %(pacas_producidas)s, %(horas_trabajadas)s, %(tiempo_de_paro)s, %(turno_inicio)s, %(turno_final)s)]
[parameters: [{'fecha': datetime.datetime(2025, 3, 25, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'pacas_producidas': 0, 'horas_trabajadas': 9.5, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'pacas_producidas': 0, 'horas_trabajadas': 0.0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 27, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 26, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_2', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 27, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_2', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 26, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_2', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}  ... displaying 10 of 1000 total bound parameter sets ...  {'fecha': datetime.datetime(2024, 11, 9, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_1', 'pacas_producidas': 0, 'horas_trabajadas': 7.0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '2pm (Turno 1)'}, {'fecha': datetime.datetime(2024, 11, 8, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_4', 'pacas_producidas': 0, 'horas_trabajadas': 8.0, 'tiempo_de_paro': 0, 'turno_inicio': '10pm', 'turno_final': '6am (Turno 3)'}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-11-13 16:40:39,027 - ERROR - ‚ùå Error cargando tabla Produccion_operario: (mysql.connector.errors.DataError) 1406 (22001): Data too long for column 'turno_final' at row 15
[SQL: INSERT INTO produccion_operario (fecha, mes, maquina, operario, referencia, pacas_producidas, horas_trabajadas, turno_inicio, turno_final) VALUES (%(fecha)s, %(mes)s, %(maquina)s, %(operario)s, %(referencia)s, %(pacas_producidas)s, %(horas_trabajadas)s, %(turno_inicio)s, %(turno_final)s)]
[parameters: [{'fecha': datetime.datetime(2025, 3, 25, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Diana', 'referencia': 'Parchesitos 22cc (6 col)', 'pacas_producidas': 0, 'horas_trabajadas': 9.5, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Diana', 'referencia': 'Pintorcitos 22cc (6 col)', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Diana', 'referencia': 'Pintorcitos 22cc (6 col)', 'pacas_producidas': 0, 'horas_trabajadas': 0.0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 27, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Eliannis', 'referencia': 'Pintorcitos 22cc (6 col)', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 26, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Diana', 'referencia': 'Pintorcitos 22cc (6 col)', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_2', 'operario': 'Yuliana Y.', 'referencia': 'Parchesitos 125 cc', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 27, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_2', 'operario': 'Lorena T.', 'referencia': 'Parchesitos 125 cc', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 26, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_2', 'operario': 'Lorena T.', 'referencia': 'Parchesitos 125 cc', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'turno_inicio': '6am', 'turno_final': '4:30pm'}  ... displaying 10 of 1000 total bound parameter sets ...  {'fecha': datetime.datetime(2024, 11, 9, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_1', 'operario': '', 'referencia': 'Parchesitos 30cc (12 col)', 'pacas_producidas': 0, 'horas_trabajadas': 7.0, 'turno_inicio': '6am', 'turno_final': '2pm (Turno 1)'}, {'fecha': datetime.datetime(2024, 11, 8, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_4', 'operario': 'Marcela', 'referencia': 'Torre 22cc (6 col)', 'pacas_producidas': 0, 'horas_trabajadas': 8.0, 'turno_inicio': '10pm', 'turno_final': '6am (Turno 3)'}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-11-13 16:40:39,762 - ERROR - ‚ùå Error cargando tabla Produccion_01: (mysql.connector.errors.DataError) 1406 (22001): Data too long for column 'turno_cierre' at row 15
[SQL: INSERT INTO produccion_01 (fecha, maquina, mes, operario, pacas_producidas, horas_trabajadas, turno_inicio, turno_cierre, horas_no_trabajadas, codigo_de_paro_1, sub_codigo_de_paro_1, tiempo_de_paro) VALUES (%(fecha)s, %(maquina)s, %(mes)s, %(operario)s, %(pacas_producidas)s, %(horas_trabajadas)s, %(turno_inicio)s, %(turno_cierre)s, %(horas_no_trabajadas)s, %(codigo_de_paro_1)s, %(sub_codigo_de_paro_1)s, %(tiempo_de_paro)s)]
[parameters: [{'fecha': datetime.datetime(2025, 3, 25, 0, 0), 'maquina': 'Vinilos_3', 'mes': 0.0, 'operario': 'Diana', 'pacas_producidas': 0, 'horas_trabajadas': 9.5, 'turno_inicio': '6am', 'turno_cierre': '4:30pm', 'horas_no_trabajadas': 0, 'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'tiempo_de_paro': 0}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'maquina': 'Vinilos_3', 'mes': 0.0, 'operario': 'Diana', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'turno_inicio': '6am', 'turno_cierre': '4:30pm', 'horas_no_trabajadas': 0, 'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'tiempo_de_paro': 0}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'maquina': 'Vinilos_3', 'mes': 0.0, 'operario': 'Diana', 'pacas_producidas': 0, 'horas_trabajadas': 0.0, 'turno_inicio': '6am', 'turno_cierre': '4:30pm', 'horas_no_trabajadas': 0, 'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'tiempo_de_paro': 0}, {'fecha': datetime.datetime(2025, 3, 27, 0, 0), 'maquina': 'Vinilos_3', 'mes': 0.0, 'operario': 'Eliannis', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'turno_inicio': '6am', 'turno_cierre': '4:30pm', 'horas_no_trabajadas': 0, 'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'tiempo_de_paro': 0}, {'fecha': datetime.datetime(2025, 3, 26, 0, 0), 'maquina': 'Vinilos_3', 'mes': 0.0, 'operario': 'Diana', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'turno_inicio': '6am', 'turno_cierre': '4:30pm', 'horas_no_trabajadas': 0, 'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'tiempo_de_paro': 0}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'maquina': 'Vinilos_2', 'mes': 0.0, 'operario': 'Yuliana Y.', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'turno_inicio': '6am', 'turno_cierre': '4:30pm', 'horas_no_trabajadas': 0, 'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'tiempo_de_paro': 0}, {'fecha': datetime.datetime(2025, 3, 27, 0, 0), 'maquina': 'Vinilos_2', 'mes': 0.0, 'operario': 'Lorena T.', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'turno_inicio': '6am', 'turno_cierre': '4:30pm', 'horas_no_trabajadas': 0, 'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'tiempo_de_paro': 0}, {'fecha': datetime.datetime(2025, 3, 26, 0, 0), 'maquina': 'Vinilos_2', 'mes': 0.0, 'operario': 'Lorena T.', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'turno_inicio': '6am', 'turno_cierre': '4:30pm', 'horas_no_trabajadas': 0, 'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'tiempo_de_paro': 0}  ... displaying 10 of 1000 total bound parameter sets ...  {'fecha': datetime.datetime(2024, 11, 9, 0, 0), 'maquina': 'Vinilos_1', 'mes': 0.0, 'operario': '', 'pacas_producidas': 0, 'horas_trabajadas': 7.0, 'turno_inicio': '6am', 'turno_cierre': '2pm (Turno 1)', 'horas_no_trabajadas': 0, 'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'tiempo_de_paro': 0}, {'fecha': datetime.datetime(2024, 11, 8, 0, 0), 'maquina': 'Vinilos_4', 'mes': 0.0, 'operario': 'Marcela', 'pacas_producidas': 0, 'horas_trabajadas': 8.0, 'turno_inicio': '10pm', 'turno_cierre': '6am (Turno 3)', 'horas_no_trabajadas': 0, 'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'tiempo_de_paro': 0}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-11-13 16:40:40,438 - ERROR - ‚ùå Error cargando tabla Produccion_03: (mysql.connector.errors.DataError) 1406 (22001): Data too long for column 'turno_final' at row 15
[SQL: INSERT INTO produccion_03 (fecha, mes, maquina, operario, pacas_producidas, horas_trabajadas, horas_no_trabajadas, codigo_de_paro_3, subcodigo_3, tiempo_de_paro, turno_inicio, turno_final) VALUES (%(fecha)s, %(mes)s, %(maquina)s, %(operario)s, %(pacas_producidas)s, %(horas_trabajadas)s, %(horas_no_trabajadas)s, %(codigo_de_paro_3)s, %(subcodigo_3)s, %(tiempo_de_paro)s, %(turno_inicio)s, %(turno_final)s)]
[parameters: [{'fecha': datetime.datetime(2025, 3, 25, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Diana', 'pacas_producidas': 0, 'horas_trabajadas': 9.5, 'horas_no_trabajadas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Diana', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'horas_no_trabajadas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Diana', 'pacas_producidas': 0, 'horas_trabajadas': 0.0, 'horas_no_trabajadas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 27, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Eliannis', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'horas_no_trabajadas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 26, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Diana', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'horas_no_trabajadas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_2', 'operario': 'Yuliana Y.', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'horas_no_trabajadas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 27, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_2', 'operario': 'Lorena T.', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'horas_no_trabajadas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 26, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_2', 'operario': 'Lorena T.', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'horas_no_trabajadas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}  ... displaying 10 of 1000 total bound parameter sets ...  {'fecha': datetime.datetime(2024, 11, 9, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_1', 'operario': '', 'pacas_producidas': 0, 'horas_trabajadas': 7.0, 'horas_no_trabajadas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '2pm (Turno 1)'}, {'fecha': datetime.datetime(2024, 11, 8, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_4', 'operario': 'Marcela', 'pacas_producidas': 0, 'horas_trabajadas': 8.0, 'horas_no_trabajadas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'tiempo_de_paro': 0, 'turno_inicio': '10pm', 'turno_final': '6am (Turno 3)'}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-11-13 16:40:41,231 - ERROR - ‚ùå Error cargando tabla Produccion_05: (mysql.connector.errors.DataError) 1406 (22001): Data too long for column 'turno_final' at row 15
[SQL: INSERT INTO produccion_05 (fecha, mes, maquina, operario, pacas_producidas, horas_trabajadas, horas_no_trabajadas, codigo_de_paro_5, subcodigo_5, codigo_5_en_horas, area_involucrada_en_subcodigo_5, tiempo_de_paro, turno_inicio, turno_final) VALUES (%(fecha)s, %(mes)s, %(maquina)s, %(operario)s, %(pacas_producidas)s, %(horas_trabajadas)s, %(horas_no_trabajadas)s, %(codigo_de_paro_5)s, %(subcodigo_5)s, %(codigo_5_en_horas)s, %(area_involucrada_en_subcodigo_5)s, %(tiempo_de_paro)s, %(turno_inicio)s, %(turno_final)s)]
[parameters: [{'fecha': datetime.datetime(2025, 3, 25, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Diana', 'pacas_producidas': 0, 'horas_trabajadas': 9.5, 'horas_no_trabajadas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Diana', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'horas_no_trabajadas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Diana', 'pacas_producidas': 0, 'horas_trabajadas': 0.0, 'horas_no_trabajadas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 27, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Eliannis', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'horas_no_trabajadas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 26, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_3', 'operario': 'Diana', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'horas_no_trabajadas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 28, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_2', 'operario': 'Yuliana Y.', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'horas_no_trabajadas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 27, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_2', 'operario': 'Lorena T.', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'horas_no_trabajadas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}, {'fecha': datetime.datetime(2025, 3, 26, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_2', 'operario': 'Lorena T.', 'pacas_producidas': 0, 'horas_trabajadas': 10.5, 'horas_no_trabajadas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '4:30pm'}  ... displaying 10 of 1000 total bound parameter sets ...  {'fecha': datetime.datetime(2024, 11, 9, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_1', 'operario': '', 'pacas_producidas': 0, 'horas_trabajadas': 7.0, 'horas_no_trabajadas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'tiempo_de_paro': 0, 'turno_inicio': '6am', 'turno_final': '2pm (Turno 1)'}, {'fecha': datetime.datetime(2024, 11, 8, 0, 0), 'mes': 0.0, 'maquina': 'Vinilos_4', 'operario': 'Marcela', 'pacas_producidas': 0, 'horas_trabajadas': 8.0, 'horas_no_trabajadas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'tiempo_de_paro': 0, 'turno_inicio': '10pm', 'turno_final': '6am (Turno 3)'}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-11-13 16:40:42,095 - ERROR - ‚ùå Error cargando tabla Porcentaje_Codigo_paro: (mysql.connector.errors.DataError) 1406 (22001): Data too long for column 'observaciones' at row 296
[SQL: INSERT INTO porcentaje_codigo_paro (codigo_de_paro_1, sub_codigo_de_paro_1, codigo_1_en_horas, codigo_de_paro_2, codigo_2_en_horas, codigo_de_paro_3, subcodigo_3, codigo_3_en_horas, codigo_de_paro_4, codigo_4_en_horas, codigo_de_paro_5, subcodigo_5, codigo_5_en_horas, area_involucrada_en_subcodigo_5, personal_involucrado, codigo_de_paro_6, codigo_6_en_horas, codigo_de_paro_7, codigo_7_en_horas, codigo_de_paro_8, codigo_8_en_horas, codigo_de_paro_9, codigo_9_en_horas, codigo_de_paro_10, codigo_10_en_horas, codigo_de_paro_11, codigo_11_en_horas, codigo_de_paro_12, codigo_12_en_horas, codigo_de_paro_13, codigo_13_en_horas, codigo_de_paro_14, codigo_14_en_horas, codigo_de_paro_15, codigo_15_en_horas, codigo_de_paro_16, codigo_16_en_horas, codigo_de_paro_17, codigo_17_en_horas, codigo_de_paro_18, codigo_18_en_horas, tiempo_de_paro, observaciones) VALUES (%(codigo_de_paro_1)s, %(sub_codigo_de_paro_1)s, %(codigo_1_en_horas)s, %(codigo_de_paro_2)s, %(codigo_2_en_horas)s, %(codigo_de_paro_3)s, %(subcodigo_3)s, %(codigo_3_en_horas)s, %(codigo_de_paro_4)s, %(codigo_4_en_horas)s, %(codigo_de_paro_5)s, %(subcodigo_5)s, %(codigo_5_en_horas)s, %(area_involucrada_en_subcodigo_5)s, %(personal_involucrado)s, %(codigo_de_paro_6)s, %(codigo_6_en_horas)s, %(codigo_de_paro_7)s, %(codigo_7_en_horas)s, %(codigo_de_paro_8)s, %(codigo_8_en_horas)s, %(codigo_de_paro_9)s, %(codigo_9_en_horas)s, %(codigo_de_paro_10)s, %(codigo_10_en_horas)s, %(codigo_de_paro_11)s, %(codigo_11_en_horas)s, %(codigo_de_paro_12)s, %(codigo_12_en_horas)s, %(codigo_de_paro_13)s, %(codigo_13_en_horas)s, %(codigo_de_paro_14)s, %(codigo_14_en_horas)s, %(codigo_de_paro_15)s, %(codigo_15_en_horas)s, %(codigo_de_paro_16)s, %(codigo_16_en_horas)s, %(codigo_de_paro_17)s, %(codigo_17_en_horas)s, %(codigo_de_paro_18)s, %(codigo_18_en_horas)s, %(tiempo_de_paro)s, %(observaciones)s)]
[parameters: [{'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'codigo_1_en_horas': 0, 'codigo_de_paro_2': 0, 'codigo_2_en_horas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'codigo_3_en_horas': 0, 'codigo_de_paro_4': 0, 'codigo_4_en_horas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'personal_involucrado': 'Juan Diego', 'codigo_de_paro_6': 0, 'codigo_6_en_horas': 0, 'codigo_de_paro_7': 0, 'codigo_7_en_horas': 0, 'codigo_de_paro_8': 0, 'codigo_8_en_horas': 0, 'codigo_de_paro_9': 0, 'codigo_9_en_horas': 0, 'codigo_de_paro_10': 0, 'codigo_10_en_horas': 0, 'codigo_de_paro_11': 0, 'codigo_11_en_horas': 0, 'codigo_de_paro_12': 0, 'codigo_12_en_horas': 0, 'codigo_de_paro_13': 0, 'codigo_13_en_horas': 0, 'codigo_de_paro_14': 0, 'codigo_14_en_horas': 0, 'codigo_de_paro_15': 0, 'codigo_15_en_horas': 0, 'codigo_de_paro_16': 0, 'codigo_16_en_horas': 0, 'codigo_de_paro_17': 0, 'codigo_17_en_horas': 0, 'codigo_de_paro_18': 0, 'codigo_18_en_horas': 0, 'tiempo_de_paro': 0, 'observaciones': ''}, {'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'codigo_1_en_horas': 0, 'codigo_de_paro_2': 0, 'codigo_2_en_horas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'codigo_3_en_horas': 0, 'codigo_de_paro_4': 0, 'codigo_4_en_horas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'personal_involucrado': '', 'codigo_de_paro_6': 0, 'codigo_6_en_horas': 0, 'codigo_de_paro_7': 0, 'codigo_7_en_horas': 0, 'codigo_de_paro_8': 0, 'codigo_8_en_horas': 0, 'codigo_de_paro_9': 0, 'codigo_9_en_horas': 0, 'codigo_de_paro_10': 0, 'codigo_10_en_horas': 0, 'codigo_de_paro_11': 0, 'codigo_11_en_horas': 0, 'codigo_de_paro_12': 0, 'codigo_12_en_horas': 0, 'codigo_de_paro_13': 0, 'codigo_13_en_horas': 0, 'codigo_de_paro_14': 0, 'codigo_14_en_horas': 0, 'codigo_de_paro_15': 0, 'codigo_15_en_horas': 0, 'codigo_de_paro_16': 0, 'codigo_16_en_horas': 0, 'codigo_de_paro_17': 0, 'codigo_17_en_horas': 0, 'codigo_de_paro_18': 0, 'codigo_18_en_horas': 0, 'tiempo_de_paro': 0, 'observaciones': ''}, {'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'codigo_1_en_horas': 0, 'codigo_de_paro_2': 0, 'codigo_2_en_horas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'codigo_3_en_horas': 0, 'codigo_de_paro_4': 0, 'codigo_4_en_horas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'personal_involucrado': '', 'codigo_de_paro_6': 0, 'codigo_6_en_horas': 0, 'codigo_de_paro_7': 0, 'codigo_7_en_horas': 0, 'codigo_de_paro_8': 0, 'codigo_8_en_horas': 0, 'codigo_de_paro_9': 0, 'codigo_9_en_horas': 0, 'codigo_de_paro_10': 0, 'codigo_10_en_horas': 0, 'codigo_de_paro_11': 0, 'codigo_11_en_horas': 0, 'codigo_de_paro_12': 0, 'codigo_12_en_horas': 0, 'codigo_de_paro_13': 0, 'codigo_13_en_horas': 0, 'codigo_de_paro_14': 0, 'codigo_14_en_horas': 0, 'codigo_de_paro_15': 0, 'codigo_15_en_horas': 0, 'codigo_de_paro_16': 0, 'codigo_16_en_horas': 0, 'codigo_de_paro_17': 0, 'codigo_17_en_horas': 0, 'codigo_de_paro_18': 0, 'codigo_18_en_horas': 0, 'tiempo_de_paro': 0, 'observaciones': ''}, {'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'codigo_1_en_horas': 0, 'codigo_de_paro_2': 0, 'codigo_2_en_horas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'codigo_3_en_horas': 0, 'codigo_de_paro_4': 0, 'codigo_4_en_horas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'personal_involucrado': '', 'codigo_de_paro_6': 0, 'codigo_6_en_horas': 0, 'codigo_de_paro_7': 0, 'codigo_7_en_horas': 0, 'codigo_de_paro_8': 0, 'codigo_8_en_horas': 0, 'codigo_de_paro_9': 0, 'codigo_9_en_horas': 0, 'codigo_de_paro_10': 0, 'codigo_10_en_horas': 0, 'codigo_de_paro_11': 0, 'codigo_11_en_horas': 0, 'codigo_de_paro_12': 0, 'codigo_12_en_horas': 0, 'codigo_de_paro_13': 0, 'codigo_13_en_horas': 0, 'codigo_de_paro_14': 0, 'codigo_14_en_horas': 0, 'codigo_de_paro_15': 0, 'codigo_15_en_horas': 0, 'codigo_de_paro_16': 0, 'codigo_16_en_horas': 0, 'codigo_de_paro_17': 0, 'codigo_17_en_horas': 0, 'codigo_de_paro_18': 0, 'codigo_18_en_horas': 0, 'tiempo_de_paro': 0, 'observaciones': ''}, {'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'codigo_1_en_horas': 0, 'codigo_de_paro_2': 0, 'codigo_2_en_horas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'codigo_3_en_horas': 0, 'codigo_de_paro_4': 0, 'codigo_4_en_horas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'personal_involucrado': 'Carlos Arturo Arg√ºello Molsalve', 'codigo_de_paro_6': 0, 'codigo_6_en_horas': 0, 'codigo_de_paro_7': 0, 'codigo_7_en_horas': 0, 'codigo_de_paro_8': 0, 'codigo_8_en_horas': 0, 'codigo_de_paro_9': 0, 'codigo_9_en_horas': 0, 'codigo_de_paro_10': 0, 'codigo_10_en_horas': 0, 'codigo_de_paro_11': 0, 'codigo_11_en_horas': 0, 'codigo_de_paro_12': 0, 'codigo_12_en_horas': 0, 'codigo_de_paro_13': 0, 'codigo_13_en_horas': 0, 'codigo_de_paro_14': 0, 'codigo_14_en_horas': 0, 'codigo_de_paro_15': 0, 'codigo_15_en_horas': 0, 'codigo_de_paro_16': 0, 'codigo_16_en_horas': 0, 'codigo_de_paro_17': 0, 'codigo_17_en_horas': 0, 'codigo_de_paro_18': 0, 'codigo_18_en_horas': 0, 'tiempo_de_paro': 0, 'observaciones': ''}, {'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'codigo_1_en_horas': 0, 'codigo_de_paro_2': 0, 'codigo_2_en_horas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'codigo_3_en_horas': 0, 'codigo_de_paro_4': 0, 'codigo_4_en_horas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'personal_involucrado': '', 'codigo_de_paro_6': 0, 'codigo_6_en_horas': 0, 'codigo_de_paro_7': 0, 'codigo_7_en_horas': 0, 'codigo_de_paro_8': 0, 'codigo_8_en_horas': 0, 'codigo_de_paro_9': 0, 'codigo_9_en_horas': 0, 'codigo_de_paro_10': 0, 'codigo_10_en_horas': 0, 'codigo_de_paro_11': 0, 'codigo_11_en_horas': 0, 'codigo_de_paro_12': 0, 'codigo_12_en_horas': 0, 'codigo_de_paro_13': 0, 'codigo_13_en_horas': 0, 'codigo_de_paro_14': 0, 'codigo_14_en_horas': 0, 'codigo_de_paro_15': 0, 'codigo_15_en_horas': 0, 'codigo_de_paro_16': 0, 'codigo_16_en_horas': 0, 'codigo_de_paro_17': 0, 'codigo_17_en_horas': 0, 'codigo_de_paro_18': 0, 'codigo_18_en_horas': 0, 'tiempo_de_paro': 0, 'observaciones': ''}, {'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'codigo_1_en_horas': 0, 'codigo_de_paro_2': 0, 'codigo_2_en_horas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'codigo_3_en_horas': 0, 'codigo_de_paro_4': 0, 'codigo_4_en_horas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'personal_involucrado': 'Lorena T.', 'codigo_de_paro_6': 0, 'codigo_6_en_horas': 0, 'codigo_de_paro_7': 0, 'codigo_7_en_horas': 0, 'codigo_de_paro_8': 0, 'codigo_8_en_horas': 0, 'codigo_de_paro_9': 0, 'codigo_9_en_horas': 0, 'codigo_de_paro_10': 0, 'codigo_10_en_horas': 0, 'codigo_de_paro_11': 0, 'codigo_11_en_horas': 0, 'codigo_de_paro_12': 0, 'codigo_12_en_horas': 0, 'codigo_de_paro_13': 0, 'codigo_13_en_horas': 0, 'codigo_de_paro_14': 0, 'codigo_14_en_horas': 0, 'codigo_de_paro_15': 0, 'codigo_15_en_horas': 0, 'codigo_de_paro_16': 0, 'codigo_16_en_horas': 0, 'codigo_de_paro_17': 0, 'codigo_17_en_horas': 0, 'codigo_de_paro_18': 0, 'codigo_18_en_horas': 0, 'tiempo_de_paro': 0, 'observaciones': ''}, {'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'codigo_1_en_horas': 0, 'codigo_de_paro_2': 0, 'codigo_2_en_horas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'codigo_3_en_horas': 0, 'codigo_de_paro_4': 0, 'codigo_4_en_horas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'personal_involucrado': '', 'codigo_de_paro_6': 0, 'codigo_6_en_horas': 0, 'codigo_de_paro_7': 0, 'codigo_7_en_horas': 0, 'codigo_de_paro_8': 0, 'codigo_8_en_horas': 0, 'codigo_de_paro_9': 0, 'codigo_9_en_horas': 0, 'codigo_de_paro_10': 0, 'codigo_10_en_horas': 0, 'codigo_de_paro_11': 0, 'codigo_11_en_horas': 0, 'codigo_de_paro_12': 0, 'codigo_12_en_horas': 0, 'codigo_de_paro_13': 0, 'codigo_13_en_horas': 0, 'codigo_de_paro_14': 0, 'codigo_14_en_horas': 0, 'codigo_de_paro_15': 0, 'codigo_15_en_horas': 0, 'codigo_de_paro_16': 0, 'codigo_16_en_horas': 0, 'codigo_de_paro_17': 0, 'codigo_17_en_horas': 0, 'codigo_de_paro_18': 0, 'codigo_18_en_horas': 0, 'tiempo_de_paro': 0, 'observaciones': ''}  ... displaying 10 of 1000 total bound parameter sets ...  {'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'codigo_1_en_horas': 0, 'codigo_de_paro_2': 0, 'codigo_2_en_horas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'codigo_3_en_horas': 0, 'codigo_de_paro_4': 0, 'codigo_4_en_horas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'personal_involucrado': '', 'codigo_de_paro_6': 0, 'codigo_6_en_horas': 0, 'codigo_de_paro_7': 0, 'codigo_7_en_horas': 0, 'codigo_de_paro_8': 0, 'codigo_8_en_horas': 0, 'codigo_de_paro_9': 0, 'codigo_9_en_horas': 0, 'codigo_de_paro_10': 0, 'codigo_10_en_horas': 0, 'codigo_de_paro_11': 0, 'codigo_11_en_horas': 0, 'codigo_de_paro_12': 0, 'codigo_12_en_horas': 0, 'codigo_de_paro_13': 0, 'codigo_13_en_horas': 0, 'codigo_de_paro_14': 0, 'codigo_14_en_horas': 0, 'codigo_de_paro_15': 0, 'codigo_15_en_horas': 0, 'codigo_de_paro_16': 0, 'codigo_16_en_horas': 0, 'codigo_de_paro_17': 0, 'codigo_17_en_horas': 0, 'codigo_de_paro_18': 0, 'codigo_18_en_horas': 0, 'tiempo_de_paro': 0, 'observaciones': ''}, {'codigo_de_paro_1': 0, 'sub_codigo_de_paro_1': 0, 'codigo_1_en_horas': 0, 'codigo_de_paro_2': 0, 'codigo_2_en_horas': 0, 'codigo_de_paro_3': 0, 'subcodigo_3': 0, 'codigo_3_en_horas': 0, 'codigo_de_paro_4': 0, 'codigo_4_en_horas': 0, 'codigo_de_paro_5': 0, 'subcodigo_5': '', 'codigo_5_en_horas': 0, 'area_involucrada_en_subcodigo_5': 0, 'personal_involucrado': '', 'codigo_de_paro_6': 0, 'codigo_6_en_horas': 0, 'codigo_de_paro_7': 0, 'codigo_7_en_horas': 0, 'codigo_de_paro_8': 0, 'codigo_8_en_horas': 0, 'codigo_de_paro_9': 0, 'codigo_9_en_horas': 0, 'codigo_de_paro_10': 0, 'codigo_10_en_horas': 0, 'codigo_de_paro_11': 0, 'codigo_11_en_horas': 0, 'codigo_de_paro_12': 0, 'codigo_12_en_horas': 0, 'codigo_de_paro_13': 0, 'codigo_13_en_horas': 0, 'codigo_de_paro_14': 0, 'codigo_14_en_horas': 0, 'codigo_de_paro_15': 0, 'codigo_15_en_horas': 0, 'codigo_de_paro_16': 0, 'codigo_16_en_horas': 0, 'codigo_de_paro_17': 0, 'codigo_17_en_horas': 0, 'codigo_de_paro_18': 0, 'codigo_18_en_horas': 0, 'tiempo_de_paro': 0, 'observaciones': ''}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-11-13 17:11:17,511 - INFO - ‚úÖ Conectado a MySQL
2025-11-13 17:11:17,512 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-13 17:11:21,747 - INFO - üßπ Limpiando y transformando datos...
2025-11-13 17:30:01,793 - INFO - ‚úÖ Conectado a MySQL
2025-11-13 17:30:01,793 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-13 17:30:06,093 - INFO - üßπ Limpiando y transformando datos...
2025-11-13 17:30:06,114 - ERROR - Error limpiando datos: 'DataFrame' object has no attribute 'tolist'
2025-11-13 17:30:06,121 - ERROR - Traceback (most recent call last):
  File "/workspaces/ProyectoOEE/etl/etl_structured.py", line 392, in clean_and_transform_data
    ejemplos_despues = df[col].head(3).tolist()
                       ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 6318, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'tolist'

2025-11-13 17:40:29,100 - INFO - ‚úÖ Conectado a MySQL
2025-11-13 17:40:29,100 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-13 17:40:33,329 - INFO - üßπ Limpiando y transformando datos...
2025-11-13 17:52:42,095 - INFO - ‚úÖ Conectado a MySQL
2025-11-13 17:52:42,095 - INFO - üìñ Leyendo archivo Excel complejo: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-13 17:52:46,966 - ERROR - ‚ùå Error ejecutando queries de limpieza: (mysql.connector.errors.ProgrammingError) 1054 (42S22): Unknown column 'area_involucrada_en_subcodigo_5' in 'field list'
[SQL: 
                CREATE TABLE IF NOT EXISTS datos_limpios_temperas_vinilos AS
                SELECT 
                    -- Columnas de fecha y tiempo
                    fecha,
                    CASE 
                        WHEN mes REGEXP '^[0-9]+$' THEN CAST(mes AS UNSIGNED)
                        WHEN mes REGEXP '^[0-9]' THEN CAST(SUBSTRING(mes, 1, LOCATE(' ', mes) - 1) AS UNSIGNED)
                        ELSE 0 
                    END as mes,
                    CASE 
                        WHEN a√±o REGEXP '^[0-9]+$' THEN CAST(a√±o AS UNSIGNED)
                        WHEN a√±o REGEXP '^[0-9]' THEN CAST(SUBSTRING(a√±o, 1, LOCATE(' ', a√±o) - 1) AS UNSIGNED)
                        ELSE 0 
                    END as a√±o,
                    
                    -- Columnas de texto (preservar original)
                    maquina,
                    operario,
                    referencia,
                    turno,
                    tipo_paro,
                    observaciones,
                    personal_involucrado,
                    area_involucrada_en_subcodigo_5,
                    subcodigo_5,
                    codigo_de_paro_1,
                    sub_codigo_de_paro_1,
                    codigo_de_paro_2,
                    codigo_de_paro_3,
                    subcodigo_3,
                    codigo_de_paro_4,
                    codigo_de_paro_5,
                    codigo_de_paro_6,
                    codigo_de_paro_7,
                    codigo_de_paro_8,
                    codigo_de_paro_9,
                    codigo_de_paro_10,
                    codigo_de_paro_11,
                    codigo_de_paro_12,
                    codigo_de_paro_13,
                    codigo_de_paro_14,
                    codigo_de_paro_15,
                    codigo_de_paro_16,
                    codigo_de_paro_17,
                    codigo_de_paro_18,
                    observaciones_de_paro,
                    
                    -- Columnas num√©ricas (extraer n√∫meros de texto)
                    CASE 
                        WHEN pacas_producidas REGEXP '^[0-9]+$' THEN CAST(pacas_producidas AS DECIMAL(10,2))
                        WHEN pacas_producidas REGEXP '^[0-9]' THEN CAST(SUBSTRING(pacas_producidas, 1, LOCATE(' ', pacas_producidas) - 1) AS DECIMAL(10,2))
                        ELSE 0 
                    END as pacas_producidas,
                    
                    CASE 
                        WHEN horas_trabajadas REGEXP '^[0-9]+$' THEN CAST(horas_trabajadas AS DECIMAL(10,2))
                        WHEN horas_trabajadas REGEXP '^[0-9]' THEN CAST(SUBSTRING(horas_trabajadas, 1, LOCATE(' ', horas_trabajadas) - 1) AS DECIMAL(10,2))
                        ELSE 0 
                    END as horas_trabajadas,
                    
                    CASE 
                        WHEN horas_no_trabajadas REGEXP '^[0-9]+$' THEN CAST(horas_no_trabajadas AS DECIMAL(10,2))
                        WHEN horas_no_trabajadas REGEXP '^[0-9]' THEN CAST(SUBSTRING(horas_no_trabajadas, 1, LOCATE(' ', horas_no_trabajadas) - 1) AS DECIMAL(10,2))
                        ELSE 0 
                    END as horas_no_trabajadas,
                    
                    CASE 
                        WHEN tiempo_de_paro REGEXP '^[0-9]+$' THEN CAST(tiempo_de_paro AS DECIMAL(10,2))
                        WHEN tiempo_de_paro REGEXP '^[0-9]' THEN CAST(SUBSTRING(tiempo_de_paro, 1, LOCATE(' ', tiempo_de_paro) - 1) AS DECIMAL(10,2))
                        ELSE 0 
                    END as tiempo_de_paro,
                    
                    -- C√≥digos de paro y horas (extraer n√∫meros)
                    CASE 
                        WHEN codigo_1_en_horas REGEXP '^[0-9]+$' THEN CAST(codigo_1_en_horas AS DECIMAL(10,2))
                        WHEN codigo_1_en_horas REGEXP '^[0-9]' THEN CAST(SUBSTRING(codigo_1_en_horas, 1, LOCATE(' ', codigo_1_en_horas) - 1) AS DECIMAL(10,2))
                        ELSE 0 
                    END as codigo_1_en_horas,
                    
                    -- Repetir para todos los c√≥digos de horas...
                    CASE 
                        WHEN codigo_2_en_horas REGEXP '^[0-9]+$' THEN CAST(codigo_2_en_horas AS DECIMAL(10,2))
                        WHEN codigo_2_en_horas REGEXP '^[0-9]' THEN CAST(SUBSTRING(codigo_2_en_horas, 1, LOCATE(' ', codigo_2_en_horas) - 1) AS DECIMAL(10,2))
                        ELSE 0 
                    END as codigo_2_en_horas,
                    
                    -- Columnas adicionales (mantener todas)
                    unidades_producidas_cada_minuto,
                    unidad_por_display,
                    display_por_paca,
                    producto
                    
                FROM datos_crudos_temperas_vinilos;
                ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-13 18:05:49,262 - INFO - ‚úÖ Conectado a MySQL
2025-11-13 18:05:49,262 - INFO - üìñ Leyendo archivo Excel: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-13 18:05:54,812 - ERROR - ‚ùå Error ejecutando queries SQL: (mysql.connector.errors.ProgrammingError) 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '*
                    
                FROM datos_crudos_temperas_vinilos' at line 42
[SQL: 
                CREATE TABLE IF NOT EXISTS datos_limpios_temperas_vinilos AS
                SELECT 
                    -- Columnas b√°sicas
                    fecha,
                    mes,
                    a√±o,
                    maquina,
                    operario,
                    referencia,
                    
                    -- Extraer n√∫meros de texto (ej: "45 pacas" -> 45)
                    CAST(REGEXP_REPLACE(pacas_producidas, '[^0-9.]', '') AS DECIMAL(10,2)) AS pacas_producidas,
                    CAST(REGEXP_REPLACE(horas_trabajadas, '[^0-9.]', '') AS DECIMAL(10,2)) AS horas_trabajadas,
                    CAST(REGEXP_REPLACE(horas_no_trabajadas, '[^0-9.]', '') AS DECIMAL(10,2)) AS horas_no_trabajadas,
                    CAST(REGEXP_REPLACE(tiempo_de_paro, '[^0-9.]', '') AS DECIMAL(10,2)) AS tiempo_de_paro,
                    
                    -- Separar turno en inicio y final
                    SUBSTRING_INDEX(turno, '-', 1) AS turno_inicio,
                    SUBSTRING_INDEX(turno, '-', -1) AS turno_final,
                    
                    -- C√≥digos de paro (extraer n√∫meros)
                    CAST(REGEXP_REPLACE(codigo_1_en_horas, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_1_en_horas,
                    CAST(REGEXP_REPLACE(codigo_2_en_horas, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_2_en_horas,
                    CAST(REGEXP_REPLACE(codigo_3_en_horas, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_3_en_horas,
                    CAST(REGEXP_REPLACE(codigo_4_en_horas, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_4_en_horas,
                    CAST(REGEXP_REPLACE(codigo_5_en_horas, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_5_en_horas,
                    
                    -- Textos originales (preservados)
                    codigo_de_paro_1,
                    sub_codigo_de_paro_1,
                    codigo_de_paro_2,
                    codigo_de_paro_3,
                    subcodigo_3,
                    codigo_de_paro_4,
                    codigo_de_paro_5,
                    subcodigo_5,
                    area_involucrada_en_subcodigo_5,
                    personal_involucrado,
                    observaciones,
                    
                    -- Preservar todas las dem√°s columnas
                    *
                    
                FROM datos_crudos_temperas_vinilos;
                ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-13 18:12:44,668 - INFO - ‚úÖ Conectado a MySQL
2025-11-13 18:12:44,668 - INFO - üìñ Leyendo archivo Excel: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-13 18:12:50,409 - ERROR - ‚ùå Error ejecutando queries SQL: (mysql.connector.errors.ProgrammingError) 1054 (42S22): Unknown column 'area_involucrada_en_subcodigo_5' in 'field list'
[SQL: 
                CREATE TABLE IF NOT EXISTS datos_limpios_temperas_vinilos AS
                SELECT 
                    -- Columnas b√°sicas
                    fecha,
                    mes,
                    a√±o,
                    maquina,
                    operario,
                    referencia,
                    
                    -- Extraer n√∫meros de texto (ej: "45 pacas" -> 45)
                    CAST(REGEXP_REPLACE(pacas_producidas, '[^0-9.]', '') AS DECIMAL(10,2)) AS pacas_producidas,
                    CAST(REGEXP_REPLACE(horas_trabajadas, '[^0-9.]', '') AS DECIMAL(10,2)) AS horas_trabajadas,
                    CAST(REGEXP_REPLACE(horas_no_trabajadas, '[^0-9.]', '') AS DECIMAL(10,2)) AS horas_no_trabajadas,
                    CAST(REGEXP_REPLACE(tiempo_de_paro, '[^0-9.]', '') AS DECIMAL(10,2)) AS tiempo_de_paro,
                    
                    -- Separar turno en inicio y final
                    SUBSTRING_INDEX(turno, '-', 1) AS turno_inicio,
                    SUBSTRING_INDEX(turno, '-', -1) AS turno_final,
                    
                    -- C√≥digos de paro (extraer n√∫meros)
                    CAST(REGEXP_REPLACE(codigo_1_en_horas, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_1_en_horas,
                    CAST(REGEXP_REPLACE(codigo_2_en_horas, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_2_en_horas,
                    CAST(REGEXP_REPLACE(codigo_3_en_horas, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_3_en_horas,
                    CAST(REGEXP_REPLACE(codigo_4_en_horas, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_4_en_horas,
                    CAST(REGEXP_REPLACE(codigo_5_en_horas, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_5_en_horas,
                    
                    -- Textos originales (preservados)
                    codigo_de_paro_1,
                    sub_codigo_de_paro_1,
                    codigo_de_paro_2,
                    codigo_de_paro_3,
                    subcodigo_3,
                    codigo_de_paro_4,
                    codigo_de_paro_5,
                    subcodigo_5,
                    area_involucrada_en_subcodigo_5,
                    personal_involucrado,
                    observaciones
                    
                FROM datos_crudos_temperas_vinilos;
                ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-13 18:21:24,396 - INFO - ‚úÖ Conectado a MySQL
2025-11-13 18:21:24,396 - INFO - üìñ Leyendo archivo Excel: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-13 18:21:30,016 - ERROR - ‚ùå Error ejecutando queries SQL: (mysql.connector.errors.ProgrammingError) 1054 (42S22): Unknown column 'NULL' in 'field list'
[SQL: 
                CREATE TABLE IF NOT EXISTS datos_limpios_temperas_vinilos AS
                SELECT 
                    -- Columnas b√°sicas
                    `fecha` AS fecha,
                    `mes` AS mes,
                    `a√±o` AS a√±o,
                    `maquina` AS maquina,
                    `operario` AS operario,
                    `referencia` AS referencia,
                    
                    -- Extraer n√∫meros de texto (ej: "45 pacas" -> 45)
                    CAST(REGEXP_REPLACE(`pacas_producidas`, '[^0-9.]', '') AS DECIMAL(10,2)) AS pacas_producidas,
                    CAST(REGEXP_REPLACE(`horas_trabajadas`, '[^0-9.]', '') AS DECIMAL(10,2)) AS horas_trabajadas,
                    CAST(REGEXP_REPLACE(`horas_no_trabajadas`, '[^0-9.]', '') AS DECIMAL(10,2)) AS horas_no_trabajadas,
                    CAST(REGEXP_REPLACE(`tiempo_de_paro`, '[^0-9.]', '') AS DECIMAL(10,2)) AS tiempo_de_paro,
                    
                    -- Separar turno en inicio y final
                    SUBSTRING_INDEX(`turno`, '-', 1) AS turno_inicio,
                    SUBSTRING_INDEX(`turno`, '-', -1) AS turno_final,
                    
                    -- C√≥digos de paro (extraer n√∫meros)
                    CAST(REGEXP_REPLACE(`codigo_1_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_1_en_horas,
                    CAST(REGEXP_REPLACE(`codigo_2_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_2_en_horas,
                    CAST(REGEXP_REPLACE(`codigo_3_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_3_en_horas,
                    CAST(REGEXP_REPLACE(`codigo_4_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_4_en_horas,
                    CAST(REGEXP_REPLACE(`codigo_5_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2)) AS codigo_5_en_horas,
                    
                    -- Textos originales (preservados)
                    `codigo_de_paro_1` AS codigo_de_paro_1,
                    `sub_codigo_de_paro_1` AS sub_codigo_de_paro_1,
                    `codigo_de_paro_2` AS codigo_de_paro_2,
                    `codigo_de_paro_3` AS codigo_de_paro_3,
                    `subcodigo_3` AS subcodigo_3,
                    `codigo_de_paro_4` AS codigo_de_paro_4,
                    `codigo_de_paro_5` AS codigo_de_paro_5,
                    `subcodigo_5` AS subcodigo_5,
                    `NULL` AS area_involucrada_en_subcodigo_5,
                    `personal_involucrado` AS personal_involucrado,
                    `observaciones_de_paro` AS observaciones
                    
                FROM datos_crudos_temperas_vinilos;
                ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-13 18:26:04,212 - INFO - ‚úÖ Conectado a MySQL
2025-11-13 18:26:04,212 - INFO - üìñ Leyendo archivo Excel: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-13 20:33:16,133 - INFO - ‚úÖ Conectado a MySQL
2025-11-13 20:33:16,137 - INFO - üìñ Leyendo archivo Excel: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-18 03:45:23,731 - INFO - ‚úÖ Conectado a MySQL
2025-11-18 03:45:23,732 - INFO - üìñ Leyendo archivo Excel: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-18 03:45:29,484 - ERROR - ‚ùå Error ejecutando queries SQL: (mysql.connector.errors.ProgrammingError) 1054 (42S22): Unknown column 'codigo_01_en_horas' in 'field list'
[SQL: 
        CREATE TABLE IF NOT EXISTS temp_codigos_paro AS
        SELECT *,
            -- Extraer minutos de las columnas de c√≥digos en horas
            
            CASE 
                WHEN `codigo_01_en_horas` IS NOT NULL AND `codigo_01_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_01_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_01,
            
            CASE 
                WHEN `codigo_02_en_horas` IS NOT NULL AND `codigo_02_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_02_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_02,
            
            CASE 
                WHEN `codigo_03_en_horas` IS NOT NULL AND `codigo_03_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_03_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_03,
            
            CASE 
                WHEN `codigo_04_en_horas` IS NOT NULL AND `codigo_04_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_04_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_04,
            
            CASE 
                WHEN `codigo_05_en_horas` IS NOT NULL AND `codigo_05_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_05_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_05,
            
            CASE 
                WHEN `codigo_06_en_horas` IS NOT NULL AND `codigo_06_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_06_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_06,
            
            CASE 
                WHEN `codigo_07_en_horas` IS NOT NULL AND `codigo_07_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_07_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_07,
            
            CASE 
                WHEN `codigo_08_en_horas` IS NOT NULL AND `codigo_08_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_08_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_08,
            
            CASE 
                WHEN `codigo_09_en_horas` IS NOT NULL AND `codigo_09_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_09_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_09,
            
            CASE 
                WHEN `codigo_10_en_horas` IS NOT NULL AND `codigo_10_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_10_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_10,
            
            CASE 
                WHEN `codigo_11_en_horas` IS NOT NULL AND `codigo_11_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_11_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_11,
            
            CASE 
                WHEN `codigo_12_en_horas` IS NOT NULL AND `codigo_12_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_12_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_12,
            
            CASE 
                WHEN `codigo_13_en_horas` IS NOT NULL AND `codigo_13_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_13_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_13,
            
            CASE 
                WHEN `codigo_14_en_horas` IS NOT NULL AND `codigo_14_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_14_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_14,
            
            CASE 
                WHEN `codigo_15_en_horas` IS NOT NULL AND `codigo_15_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_15_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_15,
            
            CASE 
                WHEN `codigo_16_en_horas` IS NOT NULL AND `codigo_16_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_16_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_16,
            
            CASE 
                WHEN `codigo_17_en_horas` IS NOT NULL AND `codigo_17_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_17_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_17,
            
            CASE 
                WHEN `codigo_18_en_horas` IS NOT NULL AND `codigo_18_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_18_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_18,
            
            -- Extraer solo el n√∫mero del c√≥digo de paro (ej: "codigo_de_paro_01" -> "01")
            
            CASE 
                WHEN `codigo_de_paro_01` IS NOT NULL AND `codigo_de_paro_01` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_01`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_01,
            
            CASE 
                WHEN `codigo_de_paro_02` IS NOT NULL AND `codigo_de_paro_02` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_02`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_02,
            
            CASE 
                WHEN `codigo_de_paro_03` IS NOT NULL AND `codigo_de_paro_03` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_03`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_03,
            
            CASE 
                WHEN `codigo_de_paro_04` IS NOT NULL AND `codigo_de_paro_04` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_04`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_04,
            
            CASE 
                WHEN `codigo_de_paro_05` IS NOT NULL AND `codigo_de_paro_05` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_05`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_05,
            
            CASE 
                WHEN `codigo_de_paro_06` IS NOT NULL AND `codigo_de_paro_06` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_06`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_06,
            
            CASE 
                WHEN `codigo_de_paro_07` IS NOT NULL AND `codigo_de_paro_07` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_07`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_07,
            
            CASE 
                WHEN `codigo_de_paro_08` IS NOT NULL AND `codigo_de_paro_08` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_08`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_08,
            
            CASE 
                WHEN `codigo_de_paro_09` IS NOT NULL AND `codigo_de_paro_09` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_09`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_09,
            
            CASE 
                WHEN `codigo_de_paro_10` IS NOT NULL AND `codigo_de_paro_10` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_10`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_10,
            
            CASE 
                WHEN `codigo_de_paro_11` IS NOT NULL AND `codigo_de_paro_11` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_11`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_11,
            
            CASE 
                WHEN `codigo_de_paro_12` IS NOT NULL AND `codigo_de_paro_12` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_12`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_12,
            
            CASE 
                WHEN `codigo_de_paro_13` IS NOT NULL AND `codigo_de_paro_13` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_13`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_13,
            
            CASE 
                WHEN `codigo_de_paro_14` IS NOT NULL AND `codigo_de_paro_14` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_14`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_14,
            
            CASE 
                WHEN `codigo_de_paro_15` IS NOT NULL AND `codigo_de_paro_15` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_15`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_15,
            
            CASE 
                WHEN `codigo_de_paro_16` IS NOT NULL AND `codigo_de_paro_16` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_16`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_16,
            
            CASE 
                WHEN `codigo_de_paro_17` IS NOT NULL AND `codigo_de_paro_17` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_17`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_17,
            
            CASE 
                WHEN `codigo_de_paro_18` IS NOT NULL AND `codigo_de_paro_18` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_18`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_18
            
        FROM datos_limpios_temperas_vinilos;
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-18 03:52:48,132 - INFO - ‚úÖ Conectado a MySQL
2025-11-18 03:52:48,132 - INFO - üìñ Leyendo archivo Excel: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-18 03:52:53,231 - ERROR - ‚ùå Error ejecutando queries SQL: (mysql.connector.errors.ProgrammingError) 1054 (42S22): Unknown column 'codigo_6_en_horas' in 'field list'
[SQL: 
        CREATE TABLE IF NOT EXISTS temp_codigos_paro AS
        SELECT *,
            -- Extraer minutos de las columnas de c√≥digos en horas
            
            CASE 
                WHEN `codigo_1_en_horas` IS NOT NULL AND `codigo_1_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_1_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_1,
            
            CASE 
                WHEN `codigo_2_en_horas` IS NOT NULL AND `codigo_2_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_2_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_2,
            
            CASE 
                WHEN `codigo_3_en_horas` IS NOT NULL AND `codigo_3_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_3_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_3,
            
            CASE 
                WHEN `codigo_4_en_horas` IS NOT NULL AND `codigo_4_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_4_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_4,
            
            CASE 
                WHEN `codigo_5_en_horas` IS NOT NULL AND `codigo_5_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_5_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_5,
            
            CASE 
                WHEN `codigo_6_en_horas` IS NOT NULL AND `codigo_6_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_6_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_6,
            
            CASE 
                WHEN `codigo_7_en_horas` IS NOT NULL AND `codigo_7_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_7_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_7,
            
            CASE 
                WHEN `codigo_8_en_horas` IS NOT NULL AND `codigo_8_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_8_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_8,
            
            CASE 
                WHEN `codigo_9_en_horas` IS NOT NULL AND `codigo_9_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_9_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_9,
            
            CASE 
                WHEN `codigo_10_en_horas` IS NOT NULL AND `codigo_10_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_10_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_10,
            
            CASE 
                WHEN `codigo_11_en_horas` IS NOT NULL AND `codigo_11_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_11_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_11,
            
            CASE 
                WHEN `codigo_12_en_horas` IS NOT NULL AND `codigo_12_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_12_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_12,
            
            CASE 
                WHEN `codigo_13_en_horas` IS NOT NULL AND `codigo_13_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_13_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_13,
            
            CASE 
                WHEN `codigo_14_en_horas` IS NOT NULL AND `codigo_14_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_14_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_14,
            
            CASE 
                WHEN `codigo_15_en_horas` IS NOT NULL AND `codigo_15_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_15_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_15,
            
            CASE 
                WHEN `codigo_16_en_horas` IS NOT NULL AND `codigo_16_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_16_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_16,
            
            CASE 
                WHEN `codigo_17_en_horas` IS NOT NULL AND `codigo_17_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_17_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_17,
            
            CASE 
                WHEN `codigo_18_en_horas` IS NOT NULL AND `codigo_18_en_horas` != '' 
                THEN CAST(REGEXP_REPLACE(`codigo_18_en_horas`, '[^0-9.]', '') AS DECIMAL(10,2))
                ELSE 0 
            END AS minutos_paro_18,
            
            -- Extraer solo el n√∫mero del c√≥digo de paro (ej: "codigo_de_paro_1" -> "1")
            
            CASE 
                WHEN `codigo_de_paro_1` IS NOT NULL AND `codigo_de_paro_1` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_1`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_1,
            
            CASE 
                WHEN `codigo_de_paro_2` IS NOT NULL AND `codigo_de_paro_2` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_2`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_2,
            
            CASE 
                WHEN `codigo_de_paro_3` IS NOT NULL AND `codigo_de_paro_3` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_3`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_3,
            
            CASE 
                WHEN `codigo_de_paro_4` IS NOT NULL AND `codigo_de_paro_4` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_4`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_4,
            
            CASE 
                WHEN `codigo_de_paro_5` IS NOT NULL AND `codigo_de_paro_5` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_5`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_5,
            
            CASE 
                WHEN `codigo_de_paro_6` IS NOT NULL AND `codigo_de_paro_6` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_6`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_6,
            
            CASE 
                WHEN `codigo_de_paro_7` IS NOT NULL AND `codigo_de_paro_7` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_7`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_7,
            
            CASE 
                WHEN `codigo_de_paro_8` IS NOT NULL AND `codigo_de_paro_8` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_8`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_8,
            
            CASE 
                WHEN `codigo_de_paro_9` IS NOT NULL AND `codigo_de_paro_9` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_9`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_9,
            
            CASE 
                WHEN `codigo_de_paro_10` IS NOT NULL AND `codigo_de_paro_10` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_10`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_10,
            
            CASE 
                WHEN `codigo_de_paro_11` IS NOT NULL AND `codigo_de_paro_11` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_11`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_11,
            
            CASE 
                WHEN `codigo_de_paro_12` IS NOT NULL AND `codigo_de_paro_12` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_12`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_12,
            
            CASE 
                WHEN `codigo_de_paro_13` IS NOT NULL AND `codigo_de_paro_13` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_13`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_13,
            
            CASE 
                WHEN `codigo_de_paro_14` IS NOT NULL AND `codigo_de_paro_14` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_14`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_14,
            
            CASE 
                WHEN `codigo_de_paro_15` IS NOT NULL AND `codigo_de_paro_15` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_15`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_15,
            
            CASE 
                WHEN `codigo_de_paro_16` IS NOT NULL AND `codigo_de_paro_16` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_16`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_16,
            
            CASE 
                WHEN `codigo_de_paro_17` IS NOT NULL AND `codigo_de_paro_17` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_17`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_17,
            
            CASE 
                WHEN `codigo_de_paro_18` IS NOT NULL AND `codigo_de_paro_18` != '' 
                THEN REGEXP_SUBSTR(`codigo_de_paro_18`, '[0-9]+')
                ELSE NULL 
            END AS numero_codigo_paro_18
            
        FROM datos_limpios_temperas_vinilos;
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-18 03:59:38,041 - INFO - ‚úÖ Conectado a MySQL
2025-11-18 03:59:38,041 - INFO - üìñ Leyendo archivo Excel: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-18 03:59:43,020 - ERROR - ‚ùå Error ejecutando queries SQL: (mysql.connector.errors.ProgrammingError) 1146 (42S02): Table 'TEMPERAS.datos_paros_procesados' doesn't exist
[SQL: 
                CREATE TABLE IF NOT EXISTS analisis_paros AS
                SELECT 
                    fecha, mes, maquina, operario,
                    numero_codigo_paro_1, minutos_paro_1,
                    numero_codigo_paro_2, minutos_paro_2,
                    numero_codigo_paro_3, minutos_paro_3,
                    numero_codigo_paro_4, minutos_paro_4,
                    numero_codigo_paro_5, minutos_paro_5,
                    numero_codigo_paro_6, minutos_paro_6,
                    numero_codigo_paro_7, minutos_paro_7,
                    numero_codigo_paro_8, minutos_paro_8,
                    numero_codigo_paro_9, minutos_paro_9,
                    numero_codigo_paro_10, minutos_paro_10,
                    numero_codigo_paro_11, minutos_paro_11,
                    numero_codigo_paro_12, minutos_paro_12,
                    numero_codigo_paro_13, minutos_paro_13,
                    numero_codigo_paro_14, minutos_paro_14,
                    numero_codigo_paro_15, minutos_paro_15,
                    numero_codigo_paro_16, minutos_paro_16,
                    numero_codigo_paro_17, minutos_paro_17,
                    numero_codigo_paro_18, minutos_paro_18,
                    (COALESCE(minutos_paro_1, 0) + COALESCE(minutos_paro_2, 0) + COALESCE(minutos_paro_3, 0) + COALESCE(minutos_paro_4, 0) + COALESCE(minutos_paro_5, 0) + COALESCE(minutos_paro_6, 0) + COALESCE(minutos_paro_7, 0) + COALESCE(minutos_paro_8, 0) + COALESCE(minutos_paro_9, 0) + COALESCE(minutos_paro_10, 0) + COALESCE(minutos_paro_11, 0) + COALESCE(minutos_paro_12, 0) + COALESCE(minutos_paro_13, 0) + COALESCE(minutos_paro_14, 0) + COALESCE(minutos_paro_15, 0) + COALESCE(minutos_paro_16, 0) + COALESCE(minutos_paro_17, 0) + COALESCE(minutos_paro_18, 0)) as total_minutos_paro
                FROM datos_paros_procesados;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-18 04:01:20,516 - INFO - ‚úÖ Conectado a MySQL
2025-11-18 04:01:20,516 - INFO - üìñ Leyendo archivo Excel: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-18 04:01:25,349 - ERROR - ‚ùå Error ejecutando queries SQL: (mysql.connector.errors.ProgrammingError) 1060 (42S21): Duplicate column name 'codigo_de_paro_2'
[SQL: 
                CREATE TABLE IF NOT EXISTS datos_limpios_temperas_vinilos AS
                SELECT 
                    -- Columnas b√°sicas
                    `fecha` AS fecha,
                    `mes` AS mes,
                    `a√±o` AS a√±o,
                    `maquina` AS maquina,
                    `operario` AS operario,
                    `referencia` AS referencia,
                    
                    -- Extraer n√∫meros de texto (ej: "45 pacas" -> 45)
                    CAST(REGEXP_REPLACE(`pacas_producidas`, '[^0-9.]', '') AS DECIMAL(10,2)) AS pacas_producidas,
                    CAST(REGEXP_REPLACE(`horas_trabajadas`, '[^0-9.]', '') AS DECIMAL(10,2)) AS horas_trabajadas,
                    CAST(REGEXP_REPLACE(`horas_no_trabajadas`, '[^0-9.]', '') AS DECIMAL(10,2)) AS horas_no_trabajadas,
                    CAST(REGEXP_REPLACE(`tiempo_de_paro`, '[^0-9.]', '') AS DECIMAL(10,2)) AS tiempo_de_paro,
                    
                    -- Separar turno en inicio y final
                    SUBSTRING_INDEX(`turno`, '-', 1) AS turno_inicio,
                    SUBSTRING_INDEX(`turno`, '-', -1) AS turno_final,
                    -- C√≥digos de paro 1 (preservar texto original para procesamiento posterior)
                    `codigo_1_en_horas` AS Codigo_1_en_horas,
                    `codigo_de_paro_1` AS Codigo_de_paro_1,
                    -- C√≥digos de paro 2 (preservar texto original para procesamiento posterior)
                    `codigo_2_en_horas` AS Codigo_2_en_horas,
                    `codigo_de_paro_2` AS Codigo_de_paro_2,
                    -- C√≥digos de paro 3 (preservar texto original para procesamiento posterior)
                    `codigo_3_en_horas` AS Codigo_3_en_horas,
                    `codigo_de_paro_3` AS Codigo_de_paro_3,
                    -- C√≥digos de paro 4 (preservar texto original para procesamiento posterior)
                    `codigo_4_en_horas` AS Codigo_4_en_horas,
                    `codigo_de_paro_4` AS Codigo_de_paro_4,
                    -- C√≥digos de paro 5 (preservar texto original para procesamiento posterior)
                    `codigo_5_en_horas` AS Codigo_5_en_horas,
                    `codigo_de_paro_5` AS Codigo_de_paro_5,
                    -- C√≥digos de paro 6 (preservar texto original para procesamiento posterior)
                    `codigo_6_en_horas` AS Codigo_6_en_horas,
                    `codigo_de_paro_6` AS Codigo_de_paro_6,
                    -- C√≥digos de paro 7 (preservar texto original para procesamiento posterior)
                    `codigo_7_en_horas` AS Codigo_7_en_horas,
                    `codigo_de_paro_7` AS Codigo_de_paro_7,
                    -- C√≥digos de paro 8 (preservar texto original para procesamiento posterior)
                    `codigo_8_en_horas` AS Codigo_8_en_horas,
                    `codigo_de_paro_8` AS Codigo_de_paro_8,
                    -- C√≥digos de paro 9 (preservar texto original para procesamiento posterior)
                    `codigo_9_en_horas` AS Codigo_9_en_horas,
                    `codigo_de_paro_9` AS Codigo_de_paro_9,
                    -- C√≥digos de paro 10 (preservar texto original para procesamiento posterior)
                    `codigo_10_en_horas` AS Codigo_10_en_horas,
                    `codigo_de_paro_10` AS Codigo_de_paro_10,
                    -- C√≥digos de paro 11 (preservar texto original para procesamiento posterior)
                    `codigo_11_en_horas` AS Codigo_11_en_horas,
                    `codigo_de_paro_11` AS Codigo_de_paro_11,
                    -- C√≥digos de paro 12 (preservar texto original para procesamiento posterior)
                    `codigo_12_en_horas` AS Codigo_12_en_horas,
                    `codigo_de_paro_12` AS Codigo_de_paro_12,
                    -- C√≥digos de paro 13 (preservar texto original para procesamiento posterior)
                    `codigo_13_en_horas` AS Codigo_13_en_horas,
                    `codigo_de_paro_13` AS Codigo_de_paro_13,
                    -- C√≥digos de paro 14 (preservar texto original para procesamiento posterior)
                    `codigo_14_en_horas` AS Codigo_14_en_horas,
                    `codigo_de_paro_14` AS Codigo_de_paro_14,
                    -- C√≥digos de paro 15 (preservar texto original para procesamiento posterior)
                    `codigo_15_en_horas` AS Codigo_15_en_horas,
                    `codigo_de_paro_15` AS Codigo_de_paro_15,
                    -- C√≥digos de paro 16 (preservar texto original para procesamiento posterior)
                    `codigo_16_en_horas` AS Codigo_16_en_horas,
                    `codigo_de_paro_16` AS Codigo_de_paro_16,
                    -- C√≥digos de paro 17 (preservar texto original para procesamiento posterior)
                    `codigo_17_en_horas` AS Codigo_17_en_horas,
                    `codigo_de_paro_17` AS Codigo_de_paro_17,
                    -- C√≥digos de paro 18 (preservar texto original para procesamiento posterior)
                    `codigo_18_en_horas` AS Codigo_18_en_horas,
                    `codigo_de_paro_18` AS Codigo_de_paro_18,
                    
                    -- Textos originales adicionales (preservados para extracci√≥n)
                    `sub_codigo_de_paro_1` AS sub_codigo_de_paro_1,
                    `codigo_de_paro_2` AS codigo_de_paro_2,
                    `codigo_de_paro_3` AS codigo_de_paro_3,
                    `subcodigo_3` AS subcodigo_3,
                    `codigo_de_paro_4` AS codigo_de_paro_4,
                    `codigo_de_paro_5` AS codigo_de_paro_5,
                    `subcodigo_5` AS subcodigo_5,
                    NULL AS area_involucrada_en_subcodigo_5,
                    `personal_involucrado` AS personal_involucrado,
                    `observaciones_de_paro` AS observaciones
                    
                FROM datos_crudos_temperas_vinilos;
                ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-18 04:18:40,326 - INFO - ‚úÖ Conectado a MySQL
2025-11-18 04:18:40,326 - INFO - üìñ Leyendo archivo Excel: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-18 04:28:47,158 - INFO - ‚úÖ Conectado a MySQL
2025-11-18 04:28:47,158 - INFO - üìñ Leyendo archivo Excel: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-18 04:31:20,998 - INFO - ‚úÖ Conectado a MySQL
2025-11-18 04:31:20,999 - INFO - üìñ Leyendo archivo Excel: /workspaces/ProyectoOEE/etl/SEGUIMIENTO TEMPERAS Y VINILOS Actividad.xlsm
2025-11-25 03:51:56,880 - etl_temperas_vinilos - INFO - üöÄ Iniciando ETL H√≠brido - Python + SQL
2025-11-25 03:53:03,307 - etl_temperas_vinilos - INFO - üöÄ Iniciando ETL H√≠brido - Python + SQL
2025-11-25 04:01:24,087 - etl_temperas_vinilos - INFO - üöÄ Iniciando ETL H√≠brido - Python + SQL
2025-11-25 04:11:35,643 - etl_temperas_vinilos - INFO - üöÄ Iniciando ETL H√≠brido - Python + SQL
2025-11-25 04:11:44,068 - etl_temperas_vinilos - INFO - üéâ ETL H√çBRIDO COMPLETADO EXITOSAMENTE!
